\documentclass[technical_document.tex]{subfiles}
\begin{document}

Eva’s electrical system consists of three subsystems. First there is the power electronics part built around the battery and the DC power input. This provides the necessary power to the other subsystems: the motor electronics and the mainboard. \section{Power Electronics}
Eva can be powered either from a 12V battery or a 12V DC power input. She has a control panel behind the front bumper from where you can switch between battery power and net power [FIG]. There is room for one big 17AH lead acid battery between Eva’s wheels as well as a smaller 7AH battery on the laptop level. The batteries cannot be active simultaneously. There is a switch to select the battery, which has to be used.    \section{Motor Electronics}
Eva sports a total of seven motors and three servos. Two Dynamixels actuate the head. The mobile base, the arm and the gripper have motors controlled by three 3mxl boards. The 3mxl boards are daisy chained on the RS485 bus and accessible via one USB port. A separate USB port connects the Dynamixels’ RS485 bus. We encountered problems talking to the 3mxl and Dynamixel over one bus. So we separated them. However it should be possible to use them all on one bus while using Shared Serial in ROS.Table \ref{tab:motorConfiguration} shows an overview of the motors and the ID’s they listen to. The baud rate for the 3mxl serial connections is 921.6 kBaud. The Dynamixels connect at 1.0 MBaud.

\begin{table}[h]
\centering
  \begin{tabular}{| l | c | r | }
    \hline
    {\bf Motor} & {\bf ID} & {\bf Type} \\ \hline
    Head pan motor 	& 	104 & 	Dynamixel \\ \hline
    Head tilt motor 	&	105 &	Dynamixel \\ \hline    Left Wheel motor   &	106 & 	3mxl \\ \hline    Right wheel motor &	107 & 	3mxl \\ \hline    Gripper motor	 & 	109 &	3mxl \\ \hline    Shoulder motor 	 &	110 &	3mxl \\ \hline    Elbow motor 		 &	111 &	3mxl \\ 
    \hline
  \end{tabular}
\caption{Motor configuration}
\label{tab:motorConfiguration}
\end{table}
\newpage\section{Mainboard}To power and control Eva’s other features we designed an electrical main board. The board functions both as a 12V supplier as well as a 5V supplier. It controls the RGB LEDs and the servos in Eva’s head. It functions also as a data acquisition board for the sensors and the bumper.Two Arduino Duemilanoves that are located at both sides of the main board provide the actual intelligence. \subsection{5V}The LSM2-T/10-D12N-C DC-DC converter serves as the 5V power supply. This device can be configured to 5V with a resistor connected between the ground pin and the trim pin. A resistance of 1.472 kΩ is needed for a 5V output. So a 3kΩ potentiometer is put in place to accommodate the desired resistance. \subsection{RGB Control}The light in Eva’s head is generated by twelve 10mm RGB LEDs on each side. The actual color of the LEDs is controlled by a pwm signal from the Arduino. TIP121 Darlington transistors amplify this signal to provide enough current to the 24 LEDs.Each LED actually consists of three LEDs. A red one, a green one and a blue one. They all consume a maximum of 20 mA. That sums up to 480mA for all the LEDs combined. The red LEDs drop 1.8V and the green and blue LEDs drop 3.8V. So to limit the current two different resistor values are needed.

\begin{equation*}
Rred =  \frac{Vcc-Vred}{Ired*24} = \frac{5-1.8}{0.020*24} = 6.7 \Omega
\end{equation*}
\begin{equation*}
Rgreen = \frac{Vcc-Vgreen}{Igreen*24} =\frac{5-3.8}{0.020*24} = 2.5 \Omega
\end{equation*}
\begin{equation*}Rblue = \frac{Vcc-Vblue}{Iblue*24} =\frac{5-3.8}{0.020*24} = 2.5 \Omega\end{equation*}
Note that it is a rather naïve implementation to link all LEDs to only one resistor. Since the current through the other LEDs will increase if one of them breaks down causing others to break down as well. The proper way to implement this would be to insert a resistor before every LED.The Darlington transistors only need a small amount of current at their base. 4.7k$\Omega$ resistors are chosen to limit the base current to 1 mA. The Darlingtons have a $h_{fe}$ of 1000 so the maximum current they can provide is 1 * 1000 = 1000 mA which is enough.   \subsection{DAQ}Eva’s bumper detects bumps by six buttons around the mobile base that provide 4 signals: front, rear, left and right. These signals are guided through a debouncing circuit. The capacitors keep the voltage to 5V when the buttons are not pressed. The Schmitt Trigger converts the signal to a logical zero.When a button is pressed it will connect the anode side of the capacitor to the ground. This will cause the charge in the capacitor to flow away and pull the signal low. Then the Schmitt Trigger will swing its signal high.  These stable signals are fed to a 4-input OR port. The output of this OR port triggers an interrupt on the Arduino, which subsequently reads the button signals to determine which bumper has been hit.  Other data acquisition done on the main board is the reading of the ultrasonic Ping sensor attached to the gripper and the 10 SRF02 sensors, which are also ultrasonic range finders.The Ping has to be triggered with a 5$\mu$s pulse and returns a high pulse with a duration that matches the time of flight on the same pin.The SRF02 sensors are all connected on an I2C bus. They are fired in two phases. First al even ones do a distance measurement then all odd sensors do theirs. This is to prevent interference of neighboring sensors.\subsection{Servos}The main board’s final function is to power the servos in Eva’s head and to perform as a hatch for Arduino signals controlling the servos.

\end{document}